(this.webpackJsonpdjango_challenge_front=this.webpackJsonpdjango_challenge_front||[]).push([[0],{101:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(9),c=a.n(r),i=(a(91),a(92),a(141)),l=a(42),s=a.n(l),u=a(23),d=(a(93),a(16)),p=a.n(d),m=a(25),h=a(12),f=a(131),b=Object(f.a)((function(e){return{mapContainer:{width:"100%",height:"100vh",margin:"auto",position:"absolute"}}})),g=a(144),v=a(136),j=a(102),E=a(142),y=a(139),k=Object(f.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3),borderRadius:"1rem",outline:0,display:"flex",flexDirection:"column"},plates:{marginBottom:"1rem"}}})),O=function(e){var t=e.open,a=e.handleOpen,r=e.handleClose,c=k(),i=Object(n.useState)(""),l=Object(h.a)(i,2),s=l[0],u=l[1];return o.a.createElement("div",null,o.a.createElement("button",{type:"button",onClick:a},"react-transition-group"),o.a.createElement(g.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:c.modal,open:t,onClose:r,closeAfterTransition:!0,onBackdropClick:function(){return r(null)},BackdropComponent:v.a,BackdropProps:{timeout:500}},o.a.createElement(j.a,{in:t},o.a.createElement("div",{className:c.paper},o.a.createElement("h2",{id:"transition-modal-title"},"Add card"),o.a.createElement(E.a,{id:"filled-basic",label:"Plates",variant:"filled",value:s||"",InputProps:{value:s||""},onChange:function(e){u(e.target.value)},className:c.plates}),o.a.createElement(y.a,{variant:"contained",color:"secondary",onClick:function(){return r(s)}},"Add")))))},C=a(145),w=a(143),x=a(74),S=a.n(x),P=a(140),T=Object(f.a)((function(e){return{root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}},helpButton:{position:"fixed",top:"5%",right:"1%"}}}));function B(e){return o.a.createElement(w.a,Object.assign({elevation:6,variant:"filled"},e))}var A=function(e){var t=e.msg,a=void 0===t?null:t,n=T(),r=o.a.useState(!1),c=Object(h.a)(r,2),i=c[0],l=c[1],s=function(e,t){"clickaway"!==t&&l(!1)};return o.a.createElement("div",{className:n.root},o.a.createElement(P.a,{color:"default","aria-label":"add",className:n.helpButton,onClick:function(){l(!0)}},o.a.createElement(S.a,null)),o.a.createElement(C.a,{open:i,autoHideDuration:6e3,onClose:s},o.a.createElement(B,{onClose:s,severity:"info"},a||"Press anywhere in the map to add a new car")))},N=a(76),I=a.n(N),_=Object(f.a)((function(e){return{addButton:{position:"fixed",bottom:e.spacing(10),right:e.spacing(10)}}})),D=a(146),L=function(e){var t=e.onClick,a=_();return o.a.createElement(D.a,{title:"Edit","aria-label":"Edit"},o.a.createElement(P.a,{"aria-label":"Edit",className:a.addButton,color:"primary",size:"small",onClick:t},o.a.createElement(I.a,null)))},R=a(77),M=a.n(R),Y=Object(f.a)((function(e){return{addButton:{position:"fixed",bottom:e.spacing(10),right:e.spacing(20)}}})),U=function(e){var t=e.onClick,a=Y();return o.a.createElement(D.a,{title:"Delete","aria-label":"Delete"},o.a.createElement(P.a,{"aria-label":"delete",className:a.addButton,color:"secondary",size:"small",onClick:t},o.a.createElement(M.a,null)))},z=Object(f.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3),borderRadius:"1rem",outline:0,display:"flex",flexDirection:"column"},plates:{marginBottom:"1rem"}}})),J=function(e){var t=e.open,a=e.handleOpen,r=e.handleClose,c=z(),i=Object(n.useState)(""),l=Object(h.a)(i,2),s=l[0],u=l[1];return o.a.createElement("div",null,o.a.createElement("button",{type:"button",onClick:a},"react-transition-group"),o.a.createElement(g.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:c.modal,open:t,onClose:r,closeAfterTransition:!0,onBackdropClick:function(){return r(null)},BackdropComponent:v.a,BackdropProps:{timeout:500}},o.a.createElement(j.a,{in:t},o.a.createElement("div",{className:c.paper},o.a.createElement("h2",{id:"transition-modal-title"},"Update card"),o.a.createElement(E.a,{id:"filled-basic",label:"New plates",variant:"filled",value:s||"",InputProps:{value:s||""},onChange:function(e){u(e.target.value)},className:c.plates}),o.a.createElement(y.a,{variant:"contained",color:"secondary",onClick:function(){return r(s)}},"Update")))))},H=!0,F=function(e){var t=e.token,a=b(),r=Object(n.useState)(""),c=Object(h.a)(r,2),i=c[0],l=c[1],u=Object(n.useState)(""),d=Object(h.a)(u,2),f=d[0],g=d[1],v=Object(n.useState)([]),j=Object(h.a)(v,2),E=j[0],y=j[1],k=Object(n.useState)(null),C=Object(h.a)(k,2),w=C[0],x=C[1],S=Object(n.useState)(!1),P=Object(h.a)(S,2),T=P[0],B=P[1],N=Object(n.useRef)(null),I=function(){var e=Object(m.a)(p.a.mark((function e(a){var n,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://django-maps-challenge.herokuapp.com/api/cars/",{mode:"cors",cache:"default",headers:{Authorization:"Token ".concat(t)}});case 2:return n=e.sent,e.next=5,n.json();case 5:o=e.sent,a&&a(o),y(o);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(m.a)(p.a.mark((function e(a){var n,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("lat",i),n.append("lon",f),n.append("placas",a),e.next=6,fetch("https://django-maps-challenge.herokuapp.com/api/cars/",{method:"POST",mode:"cors",cache:"default",headers:{Authorization:"Token ".concat(t)},body:n});case 6:return o=e.sent,e.next=9,o.json();case 9:return e.sent,H=!0,e.next=13,I();case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=Object(m.a)(p.a.mark((function e(){var a,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new FormData).append("placas",w),e.next=4,fetch("https://django-maps-challenge.herokuapp.com/api/cars/",{method:"DELETE",mode:"cors",cache:"default",headers:{Authorization:"Token ".concat(t)},body:a});case 4:return n=e.sent,e.next=7,n.json();case 7:return e.sent,H=!0,x(null),e.next=12,I();case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=Object(m.a)(p.a.mark((function e(a){var n,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new FormData,console.log(w),n.append("placas",w),n.append("newPlacas",a),e.next=6,fetch("https://django-maps-challenge.herokuapp.com/api/cars/",{method:"PATCH",mode:"cors",cache:"default",headers:{Authorization:"Token ".concat(t)},body:n});case 6:return o=e.sent,e.next=9,o.json();case 9:return e.sent,H=!0,x(null),e.next=14,I();case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=Object(n.useState)(!1),Y=Object(h.a)(M,2),z=Y[0],F=Y[1],K=function(){F(!0)},W=function(){B(!0)},G=function(){var e=Object(m.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=3;break}return e.next=3,_(t);case 3:F(!1);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=Object(m.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=3;break}return e.next=3,R(t);case 3:B(!1);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){var e={width:200,height:200,data:new Uint8Array(16e4),onAdd:function(){var e=document.createElement("canvas");e.width=this.width,e.height=this.height,this.context=e.getContext("2d")},render:function(){var e=performance.now()%1e3/1e3,t=70*e+30,n=this.context;return n.clearRect(0,0,this.width,this.height),n.beginPath(),n.arc(this.width/2,this.height/2,t,0,2*Math.PI),n.fillStyle="rgba(255, 200, 200,"+(1-e)+")",n.fill(),n.beginPath(),n.arc(this.width/2,this.height/2,30,0,2*Math.PI),n.fillStyle="rgba(255, 100, 100, 1)",n.strokeStyle="white",n.lineWidth=2+4*(1-e),n.fill(),n.stroke(),this.data=n.getImageData(0,0,this.width,this.height).data,a.triggerRepaint(),!0}},a=new s.a.Map({container:N,style:"mapbox://styles/mapbox/streets-v11",zoom:9,center:[-99.24064363651739,37.94168364640112]});a.on("mousemove",(function(e){l(e.lngLat.lat),g(e.lngLat.lng)}));a.on("click",(function(e){H?H=!1:(l(e.lngLat.lat),g(e.lngLat.lng),K(),x(null))})),a.on("load",(function(){t&&I((function(t){t.map((function(t){return function(t,n,o){a.addImage("car".concat(t,"-").concat(n),e,{pixelRatio:2}),a.addSource("car".concat(t,"-").concat(n),{type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{plates:"".concat(o)},geometry:{type:"Point",coordinates:[n,t]}}]}}),a.addLayer({id:"car".concat(t,"-").concat(n),type:"symbol",source:"car".concat(t,"-").concat(n),layout:{"icon-image":"car".concat(t,"-").concat(n)}}),a.on("click","car".concat(t,"-").concat(n),(function(e){H=!0;var t=e.features[0].geometry.coordinates.slice(),n=e.features[0].properties.plates;for(x(n);Math.abs(e.lngLat.lng-t[0])>180;)t[0]+=e.lngLat.lng>t[0]?360:-360;(new s.a.Popup).setLngLat(t).setHTML(n).addTo(a)})),a.on("mouseenter","car".concat(t,"-").concat(n),(function(){a.getCanvas().style.cursor="pointer"})),a.on("mouseleave","car".concat(t,"-").concat(n),(function(){a.getCanvas().style.cursor=""}))}(t.lat,t.lon,t.placas)}))}))}))}),[JSON.stringify(E),t]),o.a.createElement("div",null,o.a.createElement("div",{ref:function(e){return N=e},className:a.mapContainer}),o.a.createElement(A,null),w&&o.a.createElement(L,{onClick:function(){return W()}}),w&&o.a.createElement(U,{onClick:D}),o.a.createElement(O,{open:z,handleClose:G,handleOpen:K}),o.a.createElement(J,{open:T,handleClose:V,handleOpen:W}))},K=Object(f.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3),borderRadius:"1rem",outline:0,display:"flex",flexDirection:"column"},plates:{marginBottom:"1rem"}}})),W=function(e){var t=e.open,a=(e.handleOpen,e.handleClose),r=K(),c=Object(n.useState)(""),i=Object(h.a)(c,2),l=i[0],s=i[1],u=Object(n.useState)(""),d=Object(h.a)(u,2),p=d[0],m=d[1];return o.a.createElement("div",null,o.a.createElement(g.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:r.modal,open:t,onClose:a,closeAfterTransition:!0,onBackdropClick:function(){return a(null)},BackdropComponent:v.a,BackdropProps:{timeout:500}},o.a.createElement(j.a,{in:t},o.a.createElement("div",{className:r.paper},o.a.createElement("h2",{id:"transition-modal-title"},"Login"),o.a.createElement(E.a,{id:"filled-basic",label:"Username",variant:"filled",value:l||"",InputProps:{value:l||""},onChange:function(e){s(e.target.value)},className:r.plates}),o.a.createElement(E.a,{id:"filled-basic",label:"Password",variant:"filled",value:p||"",InputProps:{value:p||""},onChange:function(e){m(e.target.value)},className:r.plates}),o.a.createElement(y.a,{variant:"contained",color:"secondary",onClick:function(){a(l,p)}},"Log in")))))},G=Object(f.a)((function(e){return{root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}},helpButton:{position:"fixed",top:"5%",right:"1%"}}}));function V(e){return o.a.createElement(w.a,Object.assign({elevation:6,variant:"filled"},e))}var X=function(e){var t=e.msg,a=void 0===t?null:t,n=e.open,r=e.handleClose,c=G();return o.a.createElement("div",{className:c.root},o.a.createElement(C.a,{open:n,autoHideDuration:6e3,onClose:r},o.a.createElement(V,{onClose:r,severity:"info"},a||"Press anywhere in the map to add a new car")))},Z=function(){var e=Object(n.useState)(null),t=Object(h.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(null),i=Object(h.a)(c,2),l=i[0],s=i[1],u=Object(n.useState)(!0),d=Object(h.a)(u,2),f=d[0],b=d[1],g=o.a.useState(!1),v=Object(h.a)(g,2),j=v[0],E=v[1],y=function(){var e=Object(m.a)(p.a.mark((function e(t,a){var n,o,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("username",t),n.append("password",a),e.next=5,fetch("https://django-maps-challenge.herokuapp.com/access/",{method:"POST",mode:"cors",cache:"default",body:n});case 5:return o=e.sent,e.next=8,o.json();case 8:c=e.sent,r(c.token),s(c.username),b(!1);case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();return o.a.createElement(n.Fragment,null,o.a.createElement(F,{token:a}),o.a.createElement(W,{open:!a||f,handleClose:function(e,t){a||E(!0),b(!1),e&&t&&y(e,t)},handleOpen:function(){b(!0)}}),o.a.createElement(X,{open:j,handleClose:function(e,t){"clickaway"!==t&&E(!1)},msg:l?"Welcome back "+l:"You need to log in, so you can use the app"}))};console.log(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_API:"https://django-maps-challenge.herokuapp.com/",REACT_APP_API_MAP:"pk.eyJ1IjoiY2hhYmVsb2RlbG9jaG8iLCJhIjoiY2s5OHcyb21sMG93cTNkcXhzYjY1ZndyMyJ9.AK8_URSEiRUaKBSnsljt3g"}));var $=Object(u.a)();s.a.accessToken="pk.eyJ1IjoiY2hhYmVsb2RlbG9jaG8iLCJhIjoiY2s5OHcyb21sMG93cTNkcXhzYjY1ZndyMyJ9.AK8_URSEiRUaKBSnsljt3g";var q=function(){return o.a.createElement(i.b,{history:$},o.a.createElement("div",null,o.a.createElement(i.c,null,o.a.createElement(i.a,{exact:!0,path:"/",component:Z}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(q,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},86:function(e,t,a){e.exports=a(101)},91:function(e,t,a){},92:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},93:function(e,t,a){}},[[86,1,2]]]);
//# sourceMappingURL=main.0ff68273.chunk.js.map